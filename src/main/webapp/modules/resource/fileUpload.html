<div id="importFile" class="tabbable">
    <div class="tab-content">
        <div class="alert alert-block alert-success">
            <p>
            <ul>
                <li v-for="host in hosts" style="float:left;list-style:none;margin:3px;">
                    <input type="checkbox" :value="host" v-model="checkedHosts" />
                    <label>{{host}}</label>
                </li>
            </ul>
            </p>
            <span>&nbsp;</span>
        </div>
        <div id="home" class="tab-pane fade in active">
            <form class="form-horizontal" id="importDlg" action="" role="form" enctype="multipart/form-data" method="post" onsubmit="return false">
                <div class="form-group">
                    <div class="form-group">
                        <div class="col-md-offset-1 col-xs-10">
                            <input name="file" multiple="" type="file" id="id-input-file-3" />
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
<script>
    var importFile = new Vue({
        el: '#importFile',
        data: {
            checkedHosts:[],
            hosts:[],
            groupName:''
        },
        mounted: function () { // 初始化执行
            var $this = this;
            $('#id-input-file-3').ace_file_input({
                style: 'well',
                no_file:'没有选择文件',
                btn_choose: '选择jar文件',
                btn_change: null,
                no_icon: 'ace-icon fa fa-cloud-upload',
                droppable: true,
                thumbnail: 'small'
            }).on('file.error.ace', function(event, info) {
                 JqdeBox.message(false,'请选择文件！');
            });

            $('#validation-form').validate({
                errorElement: 'div',
                errorClass: 'help-block',
                focusInvalid: true,
                ignore: "",
                rules: {
                    itemFile: {required: true}
                },
                messages: {
                    itemFile: {required: "文件不能为空"}
                },
                highlight: function (e) {
                    $(e).closest('.form-group').removeClass('has-info').addClass('has-error');
                },
                success: function (e) {
                    $(e).closest('.form-group').removeClass('has-error');//.addClass('has-info');
                    $(e).remove();
                },
                errorPlacement: function (error, element) {
                    error.insertAfter(element);
                }
            });
        },
        watch:{
            'groupName':function(val){
                this.hostList();
            }
        },
        methods: { // 方法
            // 验证表单
            valid: function () {
                return $('#validation-form').valid();
            },
            hostList:function(){
              var $this = this;
              Jcoder.ajax('/admin/ioc/hostList', 'post',{groupName:$this.groupName},null).then(function (data) {
                    JqdeBox.unloading();
                    if(data.ok){
                      for(var key in data.obj){
                          $this.hosts.push(key);
                          if(data.obj[key].current)$this.checkedHosts.push(key);
                        }
                    }else{
                        JqdeBox.message(false, data.msg);
                    }
              });
            }
        }
    });
</script>
